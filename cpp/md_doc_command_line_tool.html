<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GRPC C++: gRPC command line tool</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GRPC C++
   &#160;<span id="projectnumber">1.57.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">gRPC command line tool </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md45"></a>
Overview</h1>
<p>This document describes the command line tool that comes with gRPC repository. It is desirable to have command line tools written in other languages roughly follow the same syntax and flags.</p>
<p>At this point, the tool needs to be built from source, and it should be moved out to grpc-tools repository as a stand alone application once it is mature enough.</p>
<h1><a class="anchor" id="autotoc_md46"></a>
Core functionality</h1>
<p>The command line tool can do the following things:</p>
<ul>
<li>Send unary rpc.</li>
<li>Attach metadata and display received metadata.</li>
<li>Handle common authentication to server.</li>
<li>Infer request/response types from server reflection result.</li>
<li>Find the request/response types from a given proto file.</li>
<li>Read proto request in text form.</li>
<li>Read request in wire form (for protobuf messages, this means serialized binary form).</li>
<li>Display proto response in text form.</li>
<li>Write response in wire form to a file.</li>
</ul>
<p>The command line tool should support the following things:</p>
<ul>
<li>List server services and methods through server reflection.</li>
<li>Fine-grained auth control (such as, use this oauth token to talk to the server).</li>
<li>Send streaming rpc.</li>
</ul>
<h1><a class="anchor" id="autotoc_md47"></a>
Code location</h1>
<p>To use the tool, you need to get the grpc repository and make sure your system has the prerequisites for building grpc from source, given in the ../BUILDING.md "installation
instructions".</p>
<p>In order to build the grpc command line tool from a fresh clone of the grpc repository, you need to run the following command to update submodules:</p>
<div class="fragment"><div class="line">git submodule update --init</div>
</div><!-- fragment --><p>Once the prerequisites are satisfied, you can build with cmake:</p>
<div class="fragment"><div class="line">$ mkdir -p cmake/build</div>
<div class="line">$ cd cmake/build</div>
<div class="line">$ cmake -DgRPC_BUILD_TESTS=ON ../..</div>
<div class="line">$ make grpc_cli</div>
</div><!-- fragment --><p>The main file can be found at <a href="https://github.com/grpc/grpc/blob/master/test/cpp/util/grpc_cli.cc">https://github.com/grpc/grpc/blob/master/test/cpp/util/grpc_cli.cc</a></p>
<h1><a class="anchor" id="autotoc_md48"></a>
Prerequisites</h1>
<p>Most <code>grpc_cli</code> commands need the server to support server reflection. See guides for <a href="https://github.com/grpc/grpc-java/blob/master/documentation/server-reflection-tutorial.md#enable-server-reflection">Java</a> , <a href="https://github.com/grpc/grpc/blob/master/doc/server_reflection_tutorial.md">C++</a> and <a href="https://github.com/grpc/grpc-go/blob/master/Documentation/server-reflection-tutorial.md">Go</a></p>
<p>Local proto files can be used as an alternative. See instructions <a href="#Call-a-remote-method">below</a>.</p>
<h1><a class="anchor" id="autotoc_md49"></a>
Usage</h1>
<h2><a class="anchor" id="autotoc_md50"></a>
List services</h2>
<p><code>grpc_cli ls</code> command lists services and methods exposed at a given port</p>
<ul>
<li><p class="startli">List all the services exposed at a given port</p>
<p class="startli">```sh $ grpc_cli ls localhost:50051 ```</p>
<p class="startli">output:</p>
<p class="startli">```none helloworld.Greeter grpc.reflection.v1alpha.ServerReflection ```</p>
<p class="startli">The <code>localhost:50051</code> part indicates the server you are connecting to.</p>
</li>
<li><p class="startli">List one service with details</p>
<p class="startli"><code>grpc_cli ls</code> command inspects a service given its full name (in the format of &lt;package&gt;.&lt;service&gt;). It can print information with a long listing format when <code>-l</code> flag is set. This flag can be used to get more details about a service.</p>
<p class="startli">```sh $ grpc_cli ls localhost:50051 helloworld.Greeter -l ```</p>
<p class="startli"><code>helloworld.Greeter</code> is full name of the service.</p>
<p class="startli">output:</p>
<p class="startli">```proto filename: helloworld.proto package: helloworld; service Greeter { rpc SayHello(helloworld.HelloRequest) returns (helloworld.HelloReply) {} }</p>
<p class="startli">```</p>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md51"></a>
List methods</h2>
<ul>
<li><p class="startli">List one method with details</p>
<p class="startli"><code>grpc_cli ls</code> command also inspects a method given its full name (in the format of &lt;package&gt;.&lt;service&gt;.&lt;method&gt;).</p>
<p class="startli">```sh $ grpc_cli ls localhost:50051 helloworld.Greeter.SayHello -l ```</p>
<p class="startli"><code>helloworld.Greeter.SayHello</code> is full name of the method.</p>
<p class="startli">output:</p>
<p class="startli">```proto rpc SayHello(helloworld.HelloRequest) returns (helloworld.HelloReply) {} ```</p>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md52"></a>
Inspect message types</h2>
<p>We can use <code>grpc_cli type</code> command to inspect request/response types given the full name of the type (in the format of &lt;package&gt;.&lt;type&gt;).</p>
<ul>
<li><p class="startli">Get information about the request type</p>
<p class="startli">```sh $ grpc_cli type localhost:50051 helloworld.HelloRequest ```</p>
<p class="startli"><code>helloworld.HelloRequest</code> is the full name of the request type.</p>
<p class="startli">output:</p>
<p class="startli">```proto message HelloRequest { optional string name = 1; } ```</p>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md53"></a>
Call a remote method</h2>
<p>We can send RPCs to a server and get responses using <code>grpc_cli call</code> command.</p>
<ul>
<li><p class="startli">Call a unary method Send a rpc to a helloworld server at <code>localhost:50051</code>:</p>
<p class="startli">``&lsquo;sh $ grpc_cli call localhost:50051 SayHello "name: 'gRPC CLI&amp;rsquo;" ```</p>
<p class="startli">output: <code>sh message: "Hello gRPC CLI"</code></p>
<p class="startli"><code>SayHello</code> is (part of) the gRPC method string. Then &lsquo;"name: 'world&amp;rsquo;"` is the text format of the request proto message. For information on more flags, look at the comments of <code>grpc_cli.cc</code>.</p>
</li>
<li><p class="startli">Use local proto files</p>
<p class="startli">If the server does not have the server reflection service, you will need to provide local proto files containing the service definition. The tool will try to find request/response types from them.</p>
<p class="startli">``&lsquo;sh $ grpc_cli call localhost:50051 SayHello "name: 'world&amp;rsquo;" \ &ndash;protofiles=examples/protos/helloworld.proto ```</p>
<p class="startli">If the proto file is not under the current directory, you can use <code>--proto_path</code> to specify new search roots (separated by colon on Mac/Linux/Cygwin or semicolon on Windows).</p>
<p class="startli">Note that the tool will always attempt to use the reflection service first, falling back to local proto files if the service is not found. Use <code>--noremotedb</code> to avoid attempting to use the reflection service.</p>
</li>
<li><p class="startli">Send non-proto rpc</p>
<p class="startli">For using gRPC with protocols other than protobuf, you will need the exact method name string and a file containing the raw bytes to be sent on the wire.</p>
<p class="startli">```bash $ grpc_cli call localhost:50051 /helloworld.Greeter/SayHello \ &ndash;input_binary_file=input.bin \ &ndash;output_binary_file=output.bin ```</p>
<p class="startli">On success, you will need to read or decode the response from the <code>output.bin</code> file. </p>
</li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 14 2023 18:27:17 for GRPC C++ by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
