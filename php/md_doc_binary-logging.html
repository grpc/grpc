<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GRPC PHP: Binary Logging</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GRPC PHP
   &#160;<span id="projectnumber">1.50.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Binary Logging </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md33"></a>
Format</h1>
<p>The log format is described in <a href="https://github.com/grpc/grpc-proto/blob/master/grpc/binlog/v1/binarylog.proto">this proto file</a>. It is intended that multiple parts of the call will be logged in separate files, and then correlated by analysis tools using the rpc_id.</p>
<h1><a class="anchor" id="autotoc_md34"></a>
API</h1>
<p>The binary logger will be a separate library from gRPC, in each language that we support. The user will need to explicitly call into the library to generate logs. The library will provide the ability to log sending or receiving, as relevant, the following on both the client and the server:</p>
<ul>
<li>Initial metadata</li>
<li>Messages</li>
<li>Status with trailing metadata from the server</li>
<li>Additional key/value pairs that are associated with a call but not sent over the wire</li>
</ul>
<p>The following is an example of what such an API could look like in C++:</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">// The context provides the method_name, deadline, peer, and metadata contents.</div>
<div class="line">// direction = CLIENT_SEND</div>
<div class="line">LogRequestHeaders(ClientContext context);</div>
<div class="line">// direction = SERVER_RECV</div>
<div class="line">LogRequestHeaders(ServerContext context);</div>
<div class="line"> </div>
<div class="line">// The context provides the metadata contents</div>
<div class="line">// direction = CLIENT_RECV</div>
<div class="line">LogResponseHeaders(ClientContext context);</div>
<div class="line">// direction = SERVER_SEND</div>
<div class="line">LogResponseHeaders(ServerContext context);</div>
<div class="line"> </div>
<div class="line">// The context provides the metadata contents</div>
<div class="line">// direction = CLIENT_RECV</div>
<div class="line">LogStatus(ClientContext context, grpc_status_code code, string details);</div>
<div class="line">// direction = SERVER_SEND</div>
<div class="line">LogStatus(ServerContext context, grpc_status_code code, string details);</div>
<div class="line"> </div>
<div class="line">// The context provides the user data contents</div>
<div class="line">// direction = CLIENT_SEND</div>
<div class="line">LogUserData(ClientContext context);</div>
<div class="line">// direction = SERVER_SEND</div>
<div class="line">LogUserData(ServerContext context);</div>
<div class="line"> </div>
<div class="line">// direction = CLIENT_SEND</div>
<div class="line">LogRequestMessage(ClientContext context, uint32_t length, T message);</div>
<div class="line">// direction = SERVER_RECV</div>
<div class="line">LogRequestMessage(ServerContext context, uint32_t length, T message);</div>
<div class="line">// direction = CLIENT_RECV</div>
<div class="line">LogResponseMessage(ClientContext context, uint32_t length, T message);</div>
<div class="line">// direction = SERVER_SEND</div>
<div class="line">LogResponseMessage(ServerContext context, uint32_t length, T message);</div>
</div><!-- fragment --><p>In all of those cases, the <code>rpc_id</code> is provided by the context, and each combination of method and context argument type implies a single direction, as noted in the comments.</p>
<p>For the message log functions, the <code>length</code> argument indicates the length of the complete message, and the <code>message</code> argument may be only part of the complete message, stripped of sensitive material and/or shortened for efficiency.</p>
<h1><a class="anchor" id="autotoc_md35"></a>
Language differences</h1>
<p>In other languages, more or less data will need to be passed explicitly as separate arguments. In some languages, for example, the metadata will be separate from the context-like object and will need to be passed as a separate argument. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Oct 14 2022 17:25:11 for GRPC PHP by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
